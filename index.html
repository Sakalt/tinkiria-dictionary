<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>チシア語辞書</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        #dictionary {
            max-width: 600px;
            margin: 20px auto;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .word-entry {
            margin-bottom: 20px;
        }
        .word-entry h2 {
            margin: 0;
            color: #00aa00;
        }
        .word-entry p {
            margin: 5px 0;
        }
        .buttons {
            display: flex;
            justify-content: space-between;
        }
        .buttons button {
            background-color: #00aa00;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
        }
        .buttons button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        #dictionary-info {
            margin-bottom: 20px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div id="dictionary">
        <div id="dictionary-info">
            <p id="dictionary-description">これはチシア語の単語を集めた辞書です。</p>
            <p id="current-status">現在の単語数: <span id="word-count"></span></p>
            <p id="example-count">総例文数: <span id="total-examples"></span></p>
            <p id="letter-frequencies">全文字の割合: <span id="letter-frequency"></span></p>
            <p id="page-status">現在のページ: <span id="current-page"></span> / <span id="total-pages"></span></p>
            <input type="text" id="searchInput" placeholder="単語を検索">
            <button id="searchButton" onclick="searchDictionary()">検索</button>
        </div>
        <div id="word-container"></div>
        <div class="buttons">
            <button id="prevButton" onclick="showPreviousPage()">前へ</button>
            <button id="nextButton" onclick="showNextPage()">次へ</button>
        </div>
    </div>

    <script>
        let dictionaryData = [];
        let filteredData = [];
        let currentPage = 0;
        const wordsPerPage = 10;

        async function fetchDictionaryData() {
            try {
                const response = await fetch('dictionary.json');
                dictionaryData = await response.json();
                filteredData = dictionaryData;
                updateDictionaryInfo();
                displayDictionary();
            } catch (error) {
                console.error('Error fetching dictionary data:', error);
            }
        }
         let dictionaryData = [];
        let filteredData = [];
        let currentPage = 0;
        const wordsPerPage = 10;
        const sortOrder = ['S', 'Z', 'T', 'D', 'K', 'G', 'F', 'V', 'P', 'B', 'Y', 'H', 'X', 'J', 'N', 'M', 'L', 'R', 'W',’A','I','U','E','O','s', 'z', 't', 'd', 'k', 'g', 'f', 'v', 'p', 'b', 'y', 'h', 'x', 'j', 'n', 'm', 'l', 'r', 'w','a', 'i', 'u', 'e', 'o'];

        function updateDictionaryInfo() {
            document.getElementById('word-count').textContent = filteredData.length;
            document.getElementById('total-pages').textContent = Math.ceil(filteredData.length / wordsPerPage);

            const totalExamples = filteredData.reduce((sum, word) => sum + word.examples.length, 0);
            document.getElementById('total-examples').textContent = totalExamples;

            const letterFrequency = calculateTotalLetterFrequency(filteredData);
            document.getElementById('letter-frequency').textContent = letterFrequency;
        }

        function displayDictionary() {
            const wordContainer = document.getElementById('word-container');
            
            currentWords.forEach(word => {
                const wordEntry = document.createElement('div');
                wordEntry.className = 'word-entry';
                
                const wordTitle = document.createElement('h2');
                wordTitle.textContent = word.tisian + ' - ' + word.japanese;
                wordEntry.appendChild(wordTitle);
                
                const wordDefinition = document.createElement('p');
                wordDefinition.textContent = '定義: ' + word.definition;
                wordEntry.appendChild(wordDefinition);

                const wordExamples = document.createElement('p');
                wordExamples.textContent = '例: ' + word.examples.join(', ');
                wordEntry.appendChild(wordExamples);
                
                wordContainer.appendChild(wordEntry);
            });

            document.getElementById('prevButton').disabled = currentPage === 0;
            document.getElementById('nextButton').disabled = end >= filteredData.length;
            document.getElementById('current-page').textContent = currentPage + 1;
        }

        function calculateTotalLetterFrequency(data) {
            const letterCounts = {};
            let totalLetters = 0;

            data.forEach(word => {
                for (const letter of word.tisian) {
                    totalLetters++;
                    if (letterCounts[letter]) {
                        letterCounts[letter]++;
                    } else {
                        letterCounts[letter] = 1;
                    }
                }
            });

            const frequencies = Object.entries(letterCounts).map(([letter, count]) => {
                return `${letter}: ${(count / totalLetters * 100).toFixed(2)}%`;
            });
            return frequencies.join(', ');
        }

        function showPreviousPage() {
            if (currentPage > 0) {
                currentPage--;
                displayDictionary();
            }
        }

        function showNextPage() {
            if ((currentPage + 1) * wordsPerPage < filteredData.length) {
                currentPage++;
                displayDictionary();
            }
        }

        function searchDictionary() {
            const searchInput = document.getElementById('searchInput').value.toLowerCase();
            filteredData = dictionaryData.filter(word => word.tisian.toLowerCase().startsWith(searchInput));
            currentPage = 0;
            updateDictionaryInfo();
            displayDictionary();
        }

        window.onload = fetchDictionaryData;
    </script>
</body>
</html>

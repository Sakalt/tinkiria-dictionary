<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>辞書</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        #dictionary {
            max-width: 600px;
            margin: 20px auto;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .word-entry {
            margin-bottom: 20px;
        }
        .word-entry h2 {
            margin: 0;
            color: #00aa00;
        }
        .word-entry p {
            margin: 5px 0;
        }
        .buttons {
            display: flex;
            justify-content: space-between;
        }
        .buttons button {
            background-color: #00aa00;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
        }
        .buttons button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        #dictionary-info {
            margin-bottom: 20px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div id="dictionary">
        <div id="dictionary-info">
            <p id="dictionary-description">これは基本的な単語を集めた辞書です。</p>
            <p id="current-status">現在の単語数: <span id="word-count"></span></p>
            <p id="page-status">現在のページ: <span id="current-page"></span> / <span id="total-pages"></span></p>
            <input type="text" id="searchInput" placeholder="単語を検索">
            <button id="searchButton" onclick="searchDictionary()">検索</button>
        </div>
        <div id="word-container"></div>
        <div class="buttons">
            <button id="prevButton" onclick="showPreviousPage()">前へ</button>
            <button id="nextButton" onclick="showNextPage()">次へ</button>
        </div>
    </div>

    <script>
        let dictionaryData = [];
        let filteredData = [];
        let currentPage = 0;
        const wordsPerPage = 10;
        const sortOrder = ['A', 'S', 'Z', 'T', 'D', 'K', 'G', 'F', 'V', 'P', 'B', 'Y', 'H', 'X', 'J', 'N', 'M', 'L', 'R', 'W', 'a', 'i', 'u', 'e', 'o'];

        async function fetchDictionaryData() {
            try {
                const response = await fetch('dictionary.json');
                dictionaryData = await response.json();
                dictionaryData.sort((a, b) => {
                    const aChar = a.english[0].toLowerCase();
                    const bChar = b.english[0].toLowerCase();
                    const aIsUpper = a.english[0].toUpperCase() === a.english[0];
                    const bIsUpper = b.english[0].toUpperCase() === b.english[0];

                    if (aIsUpper && !bIsUpper) return -1;
                    if (!aIsUpper && bIsUpper) return 1;

                    const aIndex = sortOrder.indexOf(aChar);
                    const bIndex = sortOrder.indexOf(bChar);

                    if (aIndex === bIndex) return 0;
                    return aIndex - bIndex;
                });
                filteredData = dictionaryData;
                updateDictionaryInfo();
                displayDictionary();
            } catch (error) {
                console.error('Error fetching dictionary data:', error);
            }
        }

        function updateDictionaryInfo() {
            document.getElementById('word-count').textContent = filteredData.length;
            document.getElementById('total-pages').textContent = Math.ceil(filteredData.length / wordsPerPage);
        }

        function displayDictionary() {
            const wordContainer = document.getElementById('word-container');
            wordContainer.innerHTML = '';

            const start = currentPage * wordsPerPage;
            const end = start + wordsPerPage;
            const currentWords = filteredData.slice(start, end);

            currentWords.forEach(word => {
                const wordEntry = document.createElement('div');
                wordEntry.className = 'word-entry';
                
                const wordTitle = document.createElement('h2');
                wordTitle.textContent = word.english + ' - ' + word.japanese;
                wordEntry.appendChild(wordTitle);
                
                const wordDefinition = document.createElement('p');
                wordDefinition.textContent = '定義: ' + word.definition;
                wordEntry.appendChild(wordDefinition);

                const wordExamples = document.createElement('p');
                wordExamples.textContent = '例: ' + word.examples.join(', ');
                wordEntry.appendChild(wordExamples);
                
                wordContainer.appendChild(wordEntry);
            });

            document.getElementById('prevButton').disabled = currentPage === 0;
            document.getElementById('nextButton').disabled = end >= filteredData.length;
            document.getElementById('current-page').textContent = currentPage + 1;
        }

        function showPreviousPage() {
            if (currentPage > 0) {
                currentPage--;
                displayDictionary();
            }
        }

        function showNextPage() {
            if ((currentPage + 1) * wordsPerPage < filteredData.length) {
                currentPage++;
                displayDictionary();
            }
        }

        function searchDictionary() {
            const searchInput = document.getElementById('searchInput').value.toLowerCase();
            filteredData = dictionaryData.filter(word => word.english.toLowerCase().startsWith(searchInput));
            currentPage = 0;
            updateDictionaryInfo();
            displayDictionary();
        }

        window.onload = fetchDictionaryData;
    </script>
</body>
</html>
